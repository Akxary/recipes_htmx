# recipes_htmx
Веб приложение для записи рецептов
## План развития проекта
### Привязка к рецептам:
1) Компонент. Ид, наименование, количество, ед. измерения (ложки, шт., гр). Во фронте: вам понадобится (список всех компонентов)
2) Стадии. Ид, описание, стадия до, стадия после, + опциональная привязка к компонентам через доп таблицу многие ко многим. Во фронте рядом с каждой стадией: вам понадобится
3) Лайки. Ид, пользователь, ид рецепта (внешний ключ). Во фронте отображается, поставил ли залогиненный пользователь лайк. Выдача регулируется количеством лайков
4) Комментарии. Ид, пользователь, рецепт, содержимое, время изменения, время комментария. Во фронте отображается время оставленного коммента и время его изменения, лайки на комментарии.
5) Лайки для комментариев. Ид, пользователь, ид комментария. Во фронте отображается, поставил ли залогиненный пользователь лайк. Выдача регулируется количеством лайков.
### Аутентификация
1) Выдача токена после ввода кода подтверждения на 4 часа/сутки/неделю/месяц.
2) Валидация токена, возможность разлогиниться, перезайти, автоматический выход из профиля, если токен протух
#### Система Access+Refresh:
1) Ведётся отдельная таблица под Refresh токен (refresh_tokens). 
id, 
jti - строковый ид токена, 
user_id (=user.tech_id), 
token_hash, 
expires_at, 
is_revoked, 
created_at ,
user_agent (request.headers.get("user-agent") if request else None),
ip_address (request.client.host if request else None)
2) При успешном логине пользователю в куки (нужны серты под https) выдается пара Access + Refresh. Refresh сохраняется в базу
3) Если истёк access, refresh + access обновляются. Если страница защищенная и refresh токен истёк, перекидываем пользователя на страницу логина. Если страница незащищенная и access токен истёк убираем значок, что пользователь успешно залогинен
4) Добавляем кнопку logout/logout_all для залогиненных пользователей
5) Метод борьбы с кражей токена: обнаружен reuse -> удаляем все токены пользователя, принудительно разлогиниваем его
6) Очищаем токены старше недели каждый день (джоба на расписании)
### Личный кабинет
1) Возможность добавить поля имя, био.
### Ролевая модель
1) Базово: пользовател может производить действия только со своими рецептами
2) Расширенно: есть возможность наделить пользователя правами администратора с возможностью редактирования чужих рецептов